import{P as x}from"./ProductsPagination-DSWCICMl.js";import{_ as k,i as r,r as p,c as i,b as _,a as e,F as y,d as v,o,n as C,t as l,e as c,f as m}from"./index-DqV6pCQQ.js";const w=1500,g=2e3,L={components:{ProductsPagination:x},data(){return{api:{url:"https://ec-course-api.hexschool.io/v2",path:"sky030b"},allProducts:{},pageProducts:{},pagination:{},productTemp:{},loadingStatus:{id:"",deleteId:""},isLoading:!1}},methods:{seeMore(s){this.$router.push(`/product/${s}`)},async getAllProducts(){this.isLoading=!0;try{const s=await this.axios.get(`${this.api.url}/api/${this.api.path}/products/all`);this.allProducts=s.data.products}catch(s){r.error(s.response.data.message,{autoClose:g})}this.isLoading=!1},async getPageProducts(s=1){this.isLoading=!0;try{const a=await this.axios.get(`${this.api.url}/api/${this.api.path}/products?page=${s}`);this.pageProducts=a.data.products,this.pagination=a.data.pagination}catch(a){r.error(a.response.data.message,{autoClose:g})}this.isLoading=!1},async getProduct(s){this.isLoading=!0,this.loadingStatus.id=s;try{const a=await this.axios.get(`${this.api.url}/api/${this.api.path}/product/${s}`);this.productTemp=a.data.product,this.$refs.userProductModal.openModal()}catch(a){r.error(a.response.data.message,{autoClose:g})}this.loadingStatus.id="",this.isLoading=!1},async addToCart(s,a=1){this.isLoading=!0,this.loadingStatus.id=s;const u={product_id:s,qty:a};try{const d=await this.axios.post(`${this.api.url}/api/${this.api.path}/cart`,{data:u});r.success(d.data.message,{autoClose:w})}catch(d){r.error(d.response.data.message,{autoClose:g})}this.loadingStatus.id="",this.isLoading=!1},init(){this.getPageProducts()}},watch:{isLoading(s){s?document.body.style.overflow="hidden":document.body.style.overflow=""}},mounted(){this.init()}},$={class:"container"},S={class:"table align-middle"},V=e("thead",null,[e("tr",null,[e("th",{style:{"text-align":"center"}},"圖片"),e("th",{style:{"text-align":"center"}},"商品名稱"),e("th",{style:{"text-align":"center"}},"價格"),e("th",{style:{"text-align":"center"}},"操作")])],-1),T={style:{width:"25%","text-align":"center"}},M={style:{width:"25%","text-align":"center"}},N={style:{width:"25%","text-align":"center"}},B={key:0,class:"h5"},D={key:1,class:"h6"},z={key:2,class:"h5"},F={style:{width:"25%","text-align":"center"}},I={class:"btn-group btn-group-sm"},A=["onClick"],E={key:0,class:"fas fa-spinner fa-pulse"},O=["onClick","disabled"],U={key:0,class:"fas fa-spinner fa-pulse"};function W(s,a,u,d,n,h){const b=p("loadingVue"),f=p("ProductsPagination");return o(),i(y,null,[_(b,{active:n.isLoading},null,8,["active"]),e("div",$,[e("table",S,[V,e("tbody",null,[(o(!0),i(y,null,v(n.pageProducts,t=>(o(),i("tr",{key:t.name},[e("td",T,[e("div",{style:C([{height:"100px","background-size":"contain","background-position":"center","background-repeat":"no-repeat"},{backgroundImage:`url(${t.imageUrl})`}])},null,4)]),e("td",M,l(t.title),1),e("td",N,[!t.origin_price||t.origin_price===t.price?(o(),i("div",B,l(t.price)+" 元",1)):c("",!0),t.origin_price!==t.price?(o(),i("del",D,"原價 "+l(t.origin_price)+" 元",1)):c("",!0),t.origin_price!==t.price?(o(),i("div",z,"現在只要 "+l(t.price)+" 元",1)):c("",!0)]),e("td",F,[e("div",I,[e("button",{type:"button",class:"btn btn-outline-secondary",onClick:P=>h.seeMore(t.id)},[n.loadingStatus.id===t.id?(o(),i("i",E)):c("",!0),m(" 查看更多 ")],8,A),e("button",{type:"button",class:"btn btn-outline-danger",onClick:P=>h.addToCart(t.id),disabled:n.loadingStatus.id===t.id||!t.is_enabled},[n.loadingStatus.id===t.id?(o(),i("i",U)):c("",!0),m(" 加到購物車 ")],8,O)])])]))),128))])]),_(f,{pagination:n.pagination,"get-page-products":h.getPageProducts},null,8,["pagination","get-page-products"])])],64)}const G=k(L,[["render",W]]);export{G as default};
